(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29484,        727]
NotebookOptionsPosition[     28721,        698]
NotebookOutlinePosition[     29076,        714]
CellTagsIndexPosition[     29033,        711]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["Exit"], "Input",
 CellChangeTimes->{{3.665568022148645*^9, 3.665568022744177*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"open", "[", "filename_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"dataname", "=", 
     RowBox[{
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"Last", "[", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"filename", ",", "\"\<\\\\\>\""}], "]"}], "]"}], ",", 
        "\"\<.\>\""}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", 
    RowBox[{"foreImg", "=", 
     RowBox[{"Import", "[", "filename", "]"}]}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", "filename", "}"}], ",", 
   RowBox[{"Column", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FileNameSetter", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "filename", "]"}], ",", 
           RowBox[{"Appearance", "->", "\"\<Choose file...\>\""}]}], "]"}], 
         ",", "\"\< Ignore the error message first appeared. Choose a file. \
May take seconds to open.\>\""}], "}"}], "]"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Dynamic", "[", "filename", "]"}], ",", 
        RowBox[{"Dynamic", "[", "dataname", "]"}], ","}], "*)"}], 
      RowBox[{"Dynamic", "[", 
       RowBox[{"open", "[", "filename", "]"}], "]"}]}], "}"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.665570951118121*^9, 3.6655709812558002`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"foreImg", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<ver.jpg\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"wt", ",", "ht"}], "}"}], "=", 
   RowBox[{"ImageDimensions", "[", "foreImg", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"starTrail", "[", 
   RowBox[{
   "orig_", ",", "arc_", ",", "nStars_", ",", "thickness_", ",", 
    "variance_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"coord", ":=", 
     RowBox[{"Round", "[", "orig", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"range", ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"coord", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"coord", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "wt"}], "]"}]}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"coord", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"coord", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "ht"}], "]"}]}], "}"}]}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"stars", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RandomInteger", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"coord", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"coord", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "wt"}], "]"}]}], "}"}], 
          ",", "nStars"}], "]"}], ",", 
        RowBox[{"RandomInteger", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"coord", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"coord", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "ht"}], "]"}]}], "}"}], 
          ",", "nStars"}], "]"}]}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vec", "=", 
          RowBox[{
           RowBox[{"stars", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "-", "coord"}]}], ";", 
         RowBox[{"ang", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"vec", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
            RowBox[{
             RowBox[{"a", "=", 
              RowBox[{"ArcCot", "[", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", "vec"}], "]"}], "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vec", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", "a", ",", 
               RowBox[{"Pi", "+", "a"}]}], "]"}]}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", "0", ",", 
              "Pi"}], "]"}]}], "]"}]}], ";", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0.0002", "thickness"}], ",", 
               RowBox[{"0.002", "thickness"}]}], "}"}], "]"}], "]"}], ",", 
           RowBox[{"Darker", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
              
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0.5", "-", "variance"}], " ", ",", 
                 RowBox[{"0.5", "+", "variance"}]}], "}"}], "]"}], "]"}], ",", 
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", "0.9"}], "}"}], "]"}]}], "]"}], ",", 
           RowBox[{"Circle", "[", 
            RowBox[{"coord", ",", 
             RowBox[{"EuclideanDistance", "[", 
              RowBox[{
               RowBox[{"stars", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "coord"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ang", ",", 
               RowBox[{"ang", "+", 
                RowBox[{
                 RowBox[{"arc", "/", "180"}], "*", "Pi"}]}]}], "}"}]}], 
            "]"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nStars"}], "}"}]}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "wt"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "ht"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "wt"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "ht"}], "}"}]}], "}"}]}]}], "]"}]}], 
   ")"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.665541914675309*^9, 3.665541957006296*^9}, {
   3.665542002360938*^9, 3.665542059288287*^9}, {3.665542107285242*^9, 
   3.665542126130081*^9}, {3.665542223280929*^9, 3.665542232197935*^9}, 
   3.66554239459481*^9, {3.665542526361504*^9, 3.665542540936276*^9}, 
   3.6655425924660187`*^9, 3.665543282530205*^9, {3.665543346720169*^9, 
   3.665543348310107*^9}, {3.6655436250031147`*^9, 3.665543625609104*^9}, {
   3.665544179300592*^9, 3.6655442126584578`*^9}, {3.665545119514308*^9, 
   3.665545144130207*^9}, {3.665545184707891*^9, 3.66554527189598*^9}, {
   3.665548605607654*^9, 3.665548611619295*^9}, {3.6655490278864403`*^9, 
   3.665549035285284*^9}, {3.6655490768777943`*^9, 3.665549138691801*^9}, {
   3.665549301729389*^9, 3.665549302728136*^9}, {3.665549469737385*^9, 
   3.665549514017086*^9}, {3.665549560707597*^9, 3.6655495794318857`*^9}, {
   3.665549628021078*^9, 3.66554974853261*^9}, {3.66554981963303*^9, 
   3.6655498201349277`*^9}, {3.6655499779250927`*^9, 3.665549985003676*^9}, {
   3.6655501045124617`*^9, 3.6655501233886013`*^9}, {3.6655502126088257`*^9, 
   3.665550214503491*^9}, 3.665550662443542*^9, {3.665550710316228*^9, 
   3.66555079963824*^9}, {3.6655508695304413`*^9, 3.665550870865581*^9}, {
   3.6655528606486807`*^9, 3.665552891013908*^9}, {3.665553180043029*^9, 
   3.6655532403268147`*^9}, {3.6655532711060667`*^9, 3.665553280200183*^9}, {
   3.665553375119203*^9, 3.6655534597987833`*^9}, {3.665553515732294*^9, 
   3.66555351645846*^9}, {3.665553548174432*^9, 3.665553549148156*^9}, {
   3.665553646978071*^9, 3.6655536496557837`*^9}, {3.665561402048086*^9, 
   3.6655614932812433`*^9}, {3.66556152754869*^9, 3.6655616008390837`*^9}, {
   3.665562062505796*^9, 3.665562068736143*^9}, {3.665562688210423*^9, 
   3.665562695009396*^9}, {3.665562737123928*^9, 3.6655627695023613`*^9}, {
   3.665562850394023*^9, 3.6655628715126543`*^9}, {3.6655639000867233`*^9, 
   3.66556390557889*^9}, {3.665564031549893*^9, 3.665564033938817*^9}, {
   3.665564397909443*^9, 3.665564438885942*^9}, {3.665564566019906*^9, 
   3.665564567289075*^9}, {3.665564732098413*^9, 3.6655647613775387`*^9}, 
   3.665564795480012*^9, 3.665564885214549*^9, 3.665564933146158*^9, {
   3.665565301222464*^9, 3.665565309284871*^9}, {3.665565362003871*^9, 
   3.665565428881425*^9}, {3.665565532776072*^9, 3.66556553281459*^9}, {
   3.665565718366523*^9, 3.665565735436829*^9}, 3.665565821967347*^9, {
   3.6655659099452257`*^9, 3.665565927959401*^9}, {3.665566001488895*^9, 
   3.6655661092404003`*^9}, {3.665566273951939*^9, 3.665566336160606*^9}, {
   3.665566393160186*^9, 3.66556639768461*^9}, {3.665566467292441*^9, 
   3.665566490912594*^9}, {3.66556654328434*^9, 3.6655666134355707`*^9}, {
   3.665566680534296*^9, 3.6655667045164003`*^9}, {3.665567722972968*^9, 
   3.665567740704689*^9}, {3.665569021356369*^9, 3.6655690218508043`*^9}, 
   3.665569052670583*^9, {3.665569087582842*^9, 3.665569095485283*^9}, {
   3.665569134792698*^9, 3.665569177079711*^9}, {3.665569260253096*^9, 
   3.6655692966221123`*^9}, {3.6655696007687807`*^9, 3.665569612838066*^9}, {
   3.66556967451432*^9, 3.665569687448745*^9}, {3.665569742250383*^9, 
   3.6655697615389757`*^9}, {3.6655700485795803`*^9, 3.665570054564796*^9}, {
   3.66557012067061*^9, 3.665570139192029*^9}, {3.66557018937131*^9, 
   3.6655701913932323`*^9}, {3.66557022549299*^9, 3.665570240698765*^9}, 
   3.6655709860152273`*^9, 3.665571491530899*^9, {3.665571682796173*^9, 
   3.66557168425016*^9}, {3.665584637645124*^9, 3.6655846378420477`*^9}, {
   3.6655848036424723`*^9, 3.66558482534538*^9}, {3.665584887159266*^9, 
   3.6655849180639133`*^9}, {3.66558504354243*^9, 3.66558504649192*^9}, {
   3.6655851282936153`*^9, 3.6655851285310307`*^9}, {3.6655853692369328`*^9, 
   3.6655853695622396`*^9}, 3.66559987063731*^9, {3.66559992330737*^9, 
   3.665599931619442*^9}, 3.665604244959729*^9, {3.665604295076818*^9, 
   3.665604305187851*^9}, 3.672450284016478*^9, 3.672451202381053*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ft", "[", "threshold_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"smW", "=", "200"}], ";", "\[IndentingNewLine]", 
    RowBox[{"mat", "=", 
     RowBox[{"ImageData", "[", 
      RowBox[{"ColorConvert", "[", 
       RowBox[{
        RowBox[{"ImageResize", "[", 
         RowBox[{"foreImg", ",", 
          RowBox[{"{", "smW", "}"}]}], "]"}], ",", "\"\<GrayScale\>\""}], 
       "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"smH", ",", "smW"}], "}"}], "=", 
     RowBox[{"Dimensions", "[", "mat", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"init", "=", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"queue", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"searchDir", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", "1"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"queue", ",", "init"}], "]"}], ";", 
    RowBox[{
     RowBox[{"mat", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"init", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"init", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
     RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "queue", "]"}], "\[NotEqual]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"curIdx", "=", 
         RowBox[{"queue", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"queue", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"queue", ",", "1"}], "]"}]}], ";", 
        RowBox[{"curV", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"mat", "[", 
            RowBox[{"[", 
             RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "&"}], "@@", 
          "curIdx"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"srhIdx", "=", 
            RowBox[{"curIdx", "+", 
             RowBox[{"searchDir", "[", 
              RowBox[{"[", "d", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"srhIdx", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ">=", "1"}], "&&", 
              RowBox[{
               RowBox[{"srhIdx", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "smH"}], "&&", 
              RowBox[{
               RowBox[{"srhIdx", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", "1"}], "&&", 
              RowBox[{
               RowBox[{"srhIdx", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", "smW"}]}], 
             ",", 
             RowBox[{
              RowBox[{"srhV", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"mat", "[", 
                  RowBox[{"[", 
                   RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "&"}], "@@", 
                "srhIdx"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"srhV", "\[NotEqual]", 
                   RowBox[{"-", "1"}]}], ")"}], "&&", 
                 RowBox[{"srhV", "<", "threshold"}]}], ",", 
                RowBox[{
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"queue", ",", "srhIdx"}], "]"}], ";", 
                 RowBox[{
                  RowBox[{"mat", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"srhIdx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"srhIdx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
                  RowBox[{"-", "1"}]}], ";"}], ",", "Continue"}], "]"}]}], 
             "\[IndentingNewLine]", ",", "Continue"}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "8"}], "}"}]}], "]"}], ";"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"filter", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", "smH", "}"}], ",", 
       RowBox[{"{", "smW", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"filter", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mat", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", 
          RowBox[{"-", "1"}]}], ",", "1", ",", "0"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "smH"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "smW"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"blk", "=", 
     RowBox[{"ImageResize", "[", 
      RowBox[{
       RowBox[{"MatrixPlot", "[", 
        RowBox[{"filter", ",", 
         RowBox[{"ColorRules", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "\[Rule]", "White"}], ",", 
            RowBox[{"0", "\[Rule]", "Black"}]}], "}"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}], ",", 
       RowBox[{"1.1", "wt"}]}], "]"}]}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.665588961925152*^9, 3.665588997615527*^9}, {
   3.665589223393402*^9, 3.6655892332246428`*^9}, 3.665590500164843*^9, {
   3.665591642606443*^9, 3.665591643579173*^9}, {3.6655970704962*^9, 
   3.665597070789947*^9}, {3.665597175763545*^9, 3.6655971759611387`*^9}, {
   3.665597325156027*^9, 3.66559733536996*^9}, {3.665598278837144*^9, 
   3.6655982797650433`*^9}, 3.665598775321562*^9, 3.665599071116816*^9, {
   3.665599230662937*^9, 3.665599235963236*^9}, 3.665599642870618*^9, 
   3.665599709524169*^9, 3.665599941004784*^9, {3.665602903390584*^9, 
   3.665602993109672*^9}, {3.6656031106719713`*^9, 3.665603113174459*^9}, {
   3.665603152963862*^9, 3.665603154152577*^9}, {3.665603195225622*^9, 
   3.6656031956171083`*^9}, {3.66560340090092*^9, 3.665603460620345*^9}, {
   3.6656035187712717`*^9, 3.665603558746475*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"trail", "=", 
      RowBox[{"ImageMultiply", "[", 
       RowBox[{
        RowBox[{"ColorNegate", "@", 
         RowBox[{"starTrail", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xCoord", ",", "yCoord"}], "}"}], ",", "length", ",", 
           "nStars", ",", "thickness", ",", "variance"}], "]"}]}], ",", 
        RowBox[{"ft", "[", "threshold", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageAdd", "[", 
      RowBox[{"foreImg", ",", "trail"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"threshold", ",", "0.08"}], "}"}], ",", "0.001", ",", "0.2", 
      ",", "0.001"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xCoord", ",", 
        RowBox[{"0.5", "wt"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"-", "0.2"}], "wt"}], ",", 
      RowBox[{"1.2", "wt"}], ",", 
      RowBox[{"0.1", "wt"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"yCoord", ",", 
        RowBox[{"1.5", "ht"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"-", "0.5"}], "ht"}], ",", 
      RowBox[{"4", "ht"}], ",", 
      RowBox[{"0.1", "ht"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"length", ",", "5"}], "}"}], ",", "1", ",", "20", ",", "1"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nStars", ",", "300"}], "}"}], ",", "100", ",", "600", ",", 
      "50"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"thickness", ",", "1"}], "}"}], ",", "0.1", ",", "2", ",", 
      "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"variance", ",", "0.2"}], "}"}], ",", "0", ",", "0.5", ",", 
      "0.1"}], "}"}]}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.665548902965988*^9, 3.6655490026722097`*^9}, {
   3.665549161619231*^9, 3.665549188642578*^9}, {3.665549267504781*^9, 
   3.6655492838787823`*^9}, {3.665550829178109*^9, 3.665550851263739*^9}, {
   3.665550950564809*^9, 3.6655509564493647`*^9}, {3.665553438511759*^9, 
   3.665553438845462*^9}, {3.665553482417083*^9, 3.66555349704739*^9}, {
   3.665553535797324*^9, 3.665553536369954*^9}, {3.66555517643365*^9, 
   3.665555209360273*^9}, {3.665555279173648*^9, 3.665555282258708*^9}, {
   3.6655619496510153`*^9, 3.6655619529770613`*^9}, {3.665562799308524*^9, 
   3.6655628010184593`*^9}, {3.665563365768347*^9, 3.6655633678529577`*^9}, {
   3.6655639331606913`*^9, 3.665563937103506*^9}, {3.6655640522602873`*^9, 
   3.66556405480721*^9}, {3.665564459270884*^9, 3.665564478784439*^9}, {
   3.665567873438221*^9, 3.6655679012619534`*^9}, 3.665567964603134*^9, {
   3.66556831084564*^9, 3.665568314875227*^9}, {3.6655694554593897`*^9, 
   3.665569472336298*^9}, {3.6655695306209*^9, 3.665569531835319*^9}, {
   3.665569694543768*^9, 3.665569737217064*^9}, {3.665569770691215*^9, 
   3.6655697926270733`*^9}, {3.6655698368068647`*^9, 3.665569844372603*^9}, {
   3.665569880872452*^9, 3.665569925520174*^9}, {3.665572005503379*^9, 
   3.665572016190572*^9}, {3.66557205837123*^9, 3.665572088334413*^9}, 
   3.6655721284869223`*^9, {3.665572223641302*^9, 3.665572232144533*^9}, {
   3.6655723221174593`*^9, 3.665572376607564*^9}, {3.665574639628106*^9, 
   3.6655746409136477`*^9}, {3.665574671203877*^9, 3.665574704563987*^9}, {
   3.665584655395183*^9, 3.665584686995904*^9}, {3.665584750284258*^9, 
   3.665584768220683*^9}, {3.665584924551425*^9, 3.6655849593682833`*^9}, {
   3.6655850119160147`*^9, 3.6655850140097723`*^9}, {3.665585052844431*^9, 
   3.665585053155117*^9}, {3.6655851535572157`*^9, 3.6655851611391277`*^9}, {
   3.665585238441257*^9, 3.6655852386139174`*^9}, {3.665585404818829*^9, 
   3.6655854392038317`*^9}, {3.6655855949662533`*^9, 3.665585600540028*^9}, {
   3.665585644033263*^9, 3.665585645167013*^9}, {3.665585689179028*^9, 
   3.665585721425927*^9}, {3.665585896880877*^9, 3.665585897134643*^9}, 
   3.66558593979434*^9, {3.665596947184606*^9, 3.6655969549443398`*^9}, {
   3.665598303362726*^9, 3.665598305701612*^9}, {3.665598517856917*^9, 
   3.66559853409521*^9}, {3.665598832190868*^9, 3.665598859357531*^9}, 
   3.6655989462841988`*^9, {3.665599027177631*^9, 3.6655990481282473`*^9}, {
   3.665599112967502*^9, 3.665599155096019*^9}, {3.66559920736792*^9, 
   3.66559921138898*^9}, {3.665599359576749*^9, 3.665599392626595*^9}, {
   3.6655994518258963`*^9, 3.665599455015954*^9}, {3.665599580411075*^9, 
   3.665599585442409*^9}, {3.665599678433291*^9, 3.6655996831509323`*^9}, {
   3.66559975443493*^9, 3.665599793884815*^9}, 3.665599831247096*^9, 
   3.6656005386369343`*^9, {3.665600914615213*^9, 3.665600937125183*^9}, {
   3.665603013267605*^9, 3.6656030194715633`*^9}, {3.6656030688395643`*^9, 
   3.665603071768135*^9}, {3.6656033298437862`*^9, 3.66560334614882*^9}, {
   3.66560356662743*^9, 3.6656036141338673`*^9}, {3.665603716733759*^9, 
   3.665603716776753*^9}, {3.665604276624531*^9, 3.665604277715459*^9}, 
   3.6656043212286243`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pt", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"ClickPane", "[", 
    RowBox[{
     RowBox[{"Dynamic", "[", 
      RowBox[{
       RowBox[{"Set", "[", 
        RowBox[{"POINT", ",", "pt"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"White", ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], ",", "Yellow", ",", 
          RowBox[{"Disk", "[", "]"}], ",", "Black", ",", 
          RowBox[{"Point", "[", "pt", "]"}], ",", 
          RowBox[{"Text", "[", 
           RowBox[{"POINT", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "}"}], "]"}]}], "]"}],
      ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"pt", "=", "#"}], ")"}], "&"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", "POINT", "]"}]}], "Input",
 CellChangeTimes->{{3.665588044321373*^9, 3.665588075774015*^9}}],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`POINT, StandardForm],
  ImageSizeCache->{45., {2.40576171875, 9.}}]], "Output",
 CellChangeTimes->{
  3.665591653566606*^9, 3.665591955674045*^9, 3.665592008418993*^9, 
   3.665592783822501*^9, 3.665593414078253*^9, 3.665593581646079*^9, 
   3.66559411648626*^9, 3.66559420481684*^9, 3.665594316378244*^9, 
   3.6655943713153353`*^9, 3.665595078967146*^9, 3.665595459036557*^9, 
   3.665595711670354*^9, 3.665596626404935*^9, 3.665596892639513*^9, {
   3.665597049777503*^9, 3.665597071412059*^9}, 3.6655971074675198`*^9, 
   3.66559717703505*^9, 3.6655973386600723`*^9, 3.665597586796701*^9, 
   3.665598003845739*^9, 3.672449045227531*^9, 3.672450292715888*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"blk", "=", 
  RowBox[{"MatrixPlot", "[", 
   RowBox[{"filter", ",", 
    RowBox[{"ColorRules", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", "White"}], ",", 
       RowBox[{"0", "\[Rule]", "Black"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "False"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"ht", "/", "wt"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.665598443343896*^9, 3.6655984981243973`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ani", "[", 
   RowBox[{"len_", ",", "thi_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"trail", "=", 
     RowBox[{"ImageMultiply", "[", 
      RowBox[{
       RowBox[{"ColorNegate", "@", 
        RowBox[{"starTrail", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0.5", "wt"}], ",", 
            RowBox[{"0.8", "ht"}]}], "}"}], ",", "len", ",", "300", ",", 
          "thi", ",", "var"}], "]"}]}], ",", 
       RowBox[{"ft", "[", "0.08", "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageTrim", "[", 
     RowBox[{
      RowBox[{"ImageResize", "[", 
       RowBox[{
        RowBox[{"ImageAdd", "[", 
         RowBox[{"foreImg", ",", "trail"}], "]"}], ",", "500"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "600"}], "}"}]}], "}"}]}], "]"}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{
  3.672449133607737*^9, {3.672449174657318*^9, 3.6724492134378233`*^9}, {
   3.672449261523671*^9, 3.672449303085145*^9}, 3.672449343140387*^9, {
   3.672449537593274*^9, 3.672449618895694*^9}, {3.672449911435803*^9, 
   3.672449913344727*^9}, 3.6724513691263523`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ani", "[", 
      RowBox[{"l", ",", 
       RowBox[{"0.1", "l"}], ",", 
       RowBox[{"l", "/", "12"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "32", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.672449621633946*^9, 3.672449676670703*^9}, {
  3.672449751153943*^9, 3.672449812343755*^9}, {3.672449919713566*^9, 
  3.672449956381425*^9}, {3.6724505390438833`*^9, 3.67245054306488*^9}, {
  3.672450608203168*^9, 3.672450612753838*^9}, {3.672451008827125*^9, 
  3.672451009542233*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exp", "[", 
  RowBox[{"\"\<aniTrail.gif\>\"", ",", 
   RowBox[{"Join", "[", 
    RowBox[{"s", ",", 
     RowBox[{"Reverse", "[", "s", "]"}]}], "]"}], ",", 
   RowBox[{"1", "/", "12"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.672449964596435*^9, 3.672449978132106*^9}, {
   3.6724510156628036`*^9, 3.6724510251663446`*^9}, 3.672451166749172*^9}],

Cell[BoxData["\<\"/Users/b2l/GitHub/StarTrailSimulator/aniTrail.gif\"\>"], \
"Output",
 CellChangeTimes->{3.672451173709702*^9}]
}, Open  ]]
},
WindowSize->{1135, 751},
WindowMargins->{{Automatic, 30}, {-88, Automatic}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 96, 1, 28, "Input"],
Cell[657, 23, 1427, 39, 131, "Input"],
Cell[2087, 64, 9686, 213, 284, "Input"],
Cell[11776, 279, 6896, 174, 318, "Input"],
Cell[18675, 455, 5181, 104, 114, "Input"],
Cell[CellGroupData[{
Cell[23881, 563, 1146, 32, 63, "Input"],
Cell[25030, 597, 710, 11, 28, "Output"]
}, Open  ]],
Cell[25755, 611, 477, 12, 28, "Input"],
Cell[26235, 625, 1307, 36, 46, "Input"],
Cell[27545, 663, 635, 16, 28, "Input"],
Cell[CellGroupData[{
Cell[28205, 683, 369, 8, 28, "Input"],
Cell[28577, 693, 128, 2, 28, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
